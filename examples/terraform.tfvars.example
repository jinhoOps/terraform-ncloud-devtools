# 공통
name            = "test-build-project"
description     = "my build project"
repository_name = "test-repository"
branch          = "master"
compute_id      = 1
timeout         = 200
docker_use      = true
docker_engine_id = 1

env_vars = [
  { key = "KEY",  value = "VALUE"  },
  { key = "KEY2", value = "VALUE2" },
]

# ─────────────────────────────────────────
# 시나리오 A) SourceBuild 이미지 사용
# ─────────────────────────────────────────
platform_type      = "SourceBuild"
os_id              = 1
runtime_id         = 1
runtime_version_id = 1

# build_command 사용 예
enable_build_command = true
pre_build  = ["pwd"]
in_build   = ["make"]
post_build = []

docker_image_build = {
  use        = true
  dockerfile = "/Dockerfile"
  registry   = "my-ncr"           # NCP Container Registry 이름
  image      = "custom-build-image"
  tag        = "1.0"
  latest     = false
}

linked = {
  cloud_log_analytics = false
  file_safer          = true
}

# (필요 시)
# artifact = {
#   use  = true
#   path = "/workspace/dist"
#   object_storage = {
#     bucket   = "my-bucket"
#     path     = "builds/app"
#     filename = "app.tar.gz"
#   }
#   backup = true
# }

# build_image_upload = {
#   use                    = true
#   container_registry_name = "my-ncr"
#   image_name             = "build-env-snapshot"
#   tag                    = "2025-09-25"
#   latest                 = false
# }

# ─────────────────────────────────────────
# 시나리오 B) ContainerRegistry 이미지 사용
# ─────────────────────────────────────────
# platform_type = "ContainerRegistry"
# registry_name = "my-ncr"
# image_name    = "org/base-image"
# image_tag     = "2.0"

# ─────────────────────────────────────────
# 시나리오 C) PublicRegistry 이미지 사용
# ─────────────────────────────────────────
# platform_type = "PublicRegistry"
# image_name    = "docker.io/library/alpine"
# image_tag     = "3.19"
